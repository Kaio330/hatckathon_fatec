<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <title>Sistema de Chamados - Infraestrutura</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
</head>
<body class="main-page">

  <header>
    <div class="header-content">
      <div class="logo">üìò</div>
      <div>
        <h1>Painel de Chamados</h1>
        <p>Gerenciamento de Infraestrutura</p>
      </div>
    </div>
    <button class="logout-btn" id="logoutBtn">Sair</button>
  </header>

  <section class="cards">
    <div class="card">
      <div class="card-info">
        <p>Total de Chamados</p>
        <strong id="total">0</strong>
      </div>
      <div class="card-icon total-icon"><i data-feather="file-text"></i></div>
    </div>
    <div class="card">
      <div class="card-info">
        <p>Abertos</p>
        <strong id="abertos">0</strong>
      </div>
      <div class="card-icon abertos-icon"><i data-feather="alert-circle"></i></div>
    </div>
    <div class="card">
      <div class="card-info">
        <p>Em Andamento</p>
        <strong id="andamento">0</strong>
      </div>
      <div class="card-icon andamento-icon"><i data-feather="clock"></i></div>
    </div>
    <div class="card">
      <div class="card-info">
        <p>Resolvidos</p>
        <strong id="resolvidos">0</strong>
      </div>
      <div class="card-icon resolvidos-icon"><i data-feather="check-circle"></i></div>
    </div>
  </section>

  <button class="btn" id="novoChamadoBtn">+ Abrir Novo Chamado</button>

  <section class="section">
    <h2>Chamados</h2>

    <div class="filters">
      <select id="filterStatus">
        <option value="todos">Todos os Status</option>
        <option value="Aberto">Aberto</option>
        <option value="Em Andamento">Em Andamento</option>
        <option value="Resolvido">Resolvido</option>
      </select>

      <select id="filterCategoria">
        <option value="todas">Todas as Categorias</option>
        <option value="Rede">Rede</option>
        <option value="Hardware">Hardware</option>
        <option value="Software">Software</option>
        <option value="El√©trica">El√©trica</option>
        <option value="Hidr√°ulica">Hidr√°ulica</option>
        <option value="Climatiza√ß√£o">Climatiza√ß√£o</option>
      </select>

      <select id="filterPrioridade">
        <option value="todas">Todas as Prioridades</option>
        <option value="Baixa">Baixa</option>
        <option value="M√©dia">M√©dia</option>
        <option value="Alta">Alta</option>
      </select>
    </div>

    <div id="listaChamados" class="empty">
      Nenhum chamado encontrado com os filtros selecionados.
    </div>
  </section>

  <div class="modal" id="modal">
    <div class="modal-content">
      <h3 id="modalTitulo">Novo Chamado</h3>
      <input type="text" id="titulo" placeholder="T√≠tulo do chamado" required>
      <textarea id="descricao" placeholder="Descri√ß√£o detalhada"></textarea>
      <input type="text" id="local" placeholder="Local (ex: Bloco A - 3¬∫ andar)">
      <select id="categoria">
        <option value="Rede">Rede</option>
        <option value="Hardware">Hardware</option>
        <option value="Software">Software</option>
        <option value="El√©trica">El√©trica</option>
        <option value="Hidr√°ulica">Hidr√°ulica</option>
        <option value="Climatiza√ß√£o">Climatiza√ß√£o</option>
      </select>
      <select id="prioridade">
        <option value="Baixa">Baixa</option>
        <option value="M√©dia">M√©dia</option>
        <option value="Alta">Alta</option>
      </select>
      <select id="status">
        <option value="Aberto">Aberto</option>
        <option value="Em Andamento">Em Andamento</option>
        <option value="Resolvido">Resolvido</option>
      </select>
      <label for="anexo" style="text-align: left; margin-top: 1rem;">Anexar Imagem (Opcional)</label>
      <input type="file" id="anexo" accept="image/*">
      <input type="text" id="criador" placeholder="Criado por (ex: Jo√£o Silva)">
      <div class="modal-buttons">
        <button class="cancel" id="cancelar">Cancelar</button>
        <button class="save" id="salvar">Salvar</button>
      </div>
    </div>
  </div>

<script>
    // --- 1. Selecionar TODOS os elementos ---
    const modal = document.getElementById('modal');
    const listaChamados = document.getElementById('listaChamados');
    
    // Bot√µes principais
    const novoChamadoBtn = document.getElementById('novoChamadoBtn'); // O bot√£o de abrir
    const cancelarBtn = document.getElementById('cancelar');     // O bot√£o de cancelar
    const salvarBtn = document.getElementById('salvar');         // O bot√£o de salvar
    
    // Campos do formul√°rio
    const modalTitulo = document.getElementById('modalTitulo');
    const tituloInput = document.getElementById('titulo');
    const descricaoInput = document.getElementById('descricao');
    // ... (adicione outros campos se precisar)

    // --- 2. Fun√ß√µes para controlar o Modal ---
    
    /**
     * Fun√ß√£o para MOSTRAR o modal
     * O CSS original tem "display: none".
     * N√≥s mudamos o estilo direto para "display: flex" para mostr√°-lo.
     */
    function abrirModal() {
      modal.style.display = 'flex';
    }
    
    /**
     * Fun√ß√£o para ESCONDER o modal
     */
    function fecharModal() {
      modal.style.display = 'none';
      
      // Opcional: Limpar o formul√°rio ao fechar
      modalTitulo.innerText = "Novo Chamado";
      tituloInput.value = "";
      descricaoInput.value = "";
      // ... limpar outros campos
    }

    document.getElementById('novoChamadoBtn').onclick = () => {
      modal.style.display = 'flex';
      modalTitulo.textContent = "Novo Chamado";
      editIndex = null;
      document.querySelectorAll('#modal input, #modal textarea, #modal select').forEach(e => e.value = '');
    };
    document.getElementById('cancelar').onclick = () => modal.style.display = 'none';
    window.onclick = e => { if (e.target === modal) modal.style.display = 'none'; };

    salvarBtn.onclick = () => {
      const titulo = document.getElementById('titulo').value;
      const descricao = document.getElementById('descricao').value;
      const local = document.getElementById('local').value;
      const categoria = document.getElementById('categoria').value;
      const prioridade = document.getElementById('prioridade').value;
      const status = document.getElementById('status').value;
      const criador = document.getElementById('criador').value;
      const anexoInput = document.getElementById('anexo');
      const anexoFile = anexoInput.files[0];

      if (!titulo) return alert('Informe o t√≠tulo do chamado!');

      const salvarChamadoNoSistema = (anexoBase64 = null) => {
        const chamado = {
          titulo, descricao, local, categoria, prioridade, status, criador,
          anexo: anexoBase64,
          data: new Date().toLocaleString()
        };

        if (editIndex !== null) {
          chamados[editIndex] = { ...chamados[editIndex], ...chamado };
        } else {
          chamados.push(chamado);
        }

        salvarChamados();
        modal.style.display = 'none';
        atualizarChamados();
        anexoInput.value = ''; // Limpa o campo de anexo
      };

      if (anexoFile) {
        const reader = new FileReader();
        reader.onload = (e) => {
          salvarChamadoNoSistema(e.target.result);
        };
        reader.readAsDataURL(anexoFile);
      } else {
        salvarChamadoNoSistema(editIndex !== null ? chamados[editIndex].anexo : null);
      }
    };

    function editarChamado(index) {
      const c = chamados[index];
      document.getElementById('titulo').value = c.titulo;
      document.getElementById('descricao').value = c.descricao;
      document.getElementById('local').value = c.local;
      document.getElementById('categoria').value = c.categoria;
      document.getElementById('prioridade').value = c.prioridade;
      document.getElementById('status').value = c.status;
      document.getElementById('criador').value = c.criador;
      modalTitulo.textContent = "Editar Chamado";
      modal.style.display = 'flex';
      editIndex = index;
    }

    // --- 4. Fun√ß√µes Principais do App ---

    /**
     * Fun√ß√£o para carregar/renderizar os chamados
     * (Voc√™ precisa implementar a l√≥gica de buscar do localStorage ou API)
     */
    function carregarChamados() {
      // Limpa a lista antes de carregar
      listaChamados.innerHTML = ""; 
      
      // ... (Sua l√≥gica para buscar dados e criar os cards) ...
      
      // Exemplo de como mostrar/esconder a msg "Nenhum chamado"
      // Se, ap√≥s buscar os dados, a lista estiver vazia:
      const temChamados = listaChamados.querySelector('.chamado');
      
      if (!temChamados) {
        listaChamados.classList.add('empty');
        listaChamados.innerHTML = '<div class="empty">Nenhum chamado encontrado.</div>';
      } else {
        listaChamados.classList.remove('empty');
      }
    }

    // --- 5. Inicializa√ß√£o ---
    // Carrega os chamados assim que a p√°gina abre
    carregarChamados();

  </script>
</body>
</html>
</body>
</html>